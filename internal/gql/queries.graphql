fragment NoteListDoc on Micro_post {
  id
  slug
  title
  content
  publishedAt
  authors {
    name
    slug
    bio
    avatar {
      url
      alt
      width
      height
    }
  }
  tags {
    id
    name
    title
  }
  attachment {
    url
    alt
    width
    height
    filename
    mimeType
  }
  meta {
    description
  }
}

query ListNotes($page: Int!, $limit: Int!) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query ListNotesByType($page: Int!, $limit: Int!, $postType: Micro_post_post_type_Input!) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      post_type: { equals: $postType }
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query ListNotesByTagIDs($page: Int!, $limit: Int!, $tagIDs: [JSON!]!) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      tags: { in: $tagIDs }
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query ListNotesByTagIDsAndType(
  $page: Int!
  $limit: Int!
  $tagIDs: [JSON!]!
  $postType: Micro_post_post_type_Input!
) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      tags: { in: $tagIDs }
      post_type: { equals: $postType }
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query NotesByAuthorSlug($slug: String!, $page: Int!, $limit: Int!) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      authorSlug: { equals: $slug }
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query NotesByAuthorSlugAndType(
  $slug: String!
  $page: Int!
  $limit: Int!
  $postType: Micro_post_post_type_Input!
) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      authorSlug: { equals: $slug }
      post_type: { equals: $postType }
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query ListNotesByAuthorAndTagIDs($slug: String!, $page: Int!, $limit: Int!, $tagIDs: [JSON!]!) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      authorSlug: { equals: $slug }
      tags: { in: $tagIDs }
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query ListNotesByAuthorTagIDsAndType(
  $slug: String!
  $page: Int!
  $limit: Int!
  $tagIDs: [JSON!]!
  $postType: Micro_post_post_type_Input!
) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      authorSlug: { equals: $slug }
      tags: { in: $tagIDs }
      post_type: { equals: $postType }
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query SearchNotes($query: String!, $page: Int!, $limit: Int!) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      OR: [
        { title: { like: $query } }
        { title: { contains: $query } }
        { content: { like: $query } }
        { content: { contains: $query } }
        { meta__description: { like: $query } }
        { meta__description: { contains: $query } }
      ]
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query SearchNotesByType(
  $query: String!
  $page: Int!
  $limit: Int!
  $postType: Micro_post_post_type_Input!
) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      post_type: { equals: $postType }
      OR: [
        { title: { like: $query } }
        { title: { contains: $query } }
        { content: { like: $query } }
        { content: { contains: $query } }
        { meta__description: { like: $query } }
        { meta__description: { contains: $query } }
      ]
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query SearchNotesByTagIDs($query: String!, $page: Int!, $limit: Int!, $tagIDs: [JSON!]!) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      tags: { in: $tagIDs }
      OR: [
        { title: { like: $query } }
        { title: { contains: $query } }
        { content: { like: $query } }
        { content: { contains: $query } }
        { meta__description: { like: $query } }
        { meta__description: { contains: $query } }
      ]
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query SearchNotesByTagIDsAndType(
  $query: String!
  $page: Int!
  $limit: Int!
  $tagIDs: [JSON!]!
  $postType: Micro_post_post_type_Input!
) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      tags: { in: $tagIDs }
      post_type: { equals: $postType }
      OR: [
        { title: { like: $query } }
        { title: { contains: $query } }
        { content: { like: $query } }
        { content: { contains: $query } }
        { meta__description: { like: $query } }
        { meta__description: { contains: $query } }
      ]
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query SearchNotesByAuthorSlug($query: String!, $slug: String!, $page: Int!, $limit: Int!) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      authorSlug: { equals: $slug }
      OR: [
        { title: { like: $query } }
        { title: { contains: $query } }
        { content: { like: $query } }
        { content: { contains: $query } }
        { meta__description: { like: $query } }
        { meta__description: { contains: $query } }
      ]
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query SearchNotesByAuthorSlugAndType(
  $query: String!
  $slug: String!
  $page: Int!
  $limit: Int!
  $postType: Micro_post_post_type_Input!
) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      authorSlug: { equals: $slug }
      post_type: { equals: $postType }
      OR: [
        { title: { like: $query } }
        { title: { contains: $query } }
        { content: { like: $query } }
        { content: { contains: $query } }
        { meta__description: { like: $query } }
        { meta__description: { contains: $query } }
      ]
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query SearchNotesByAuthorAndTagIDs(
  $query: String!
  $slug: String!
  $page: Int!
  $limit: Int!
  $tagIDs: [JSON!]!
) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      authorSlug: { equals: $slug }
      tags: { in: $tagIDs }
      OR: [
        { title: { like: $query } }
        { title: { contains: $query } }
        { content: { like: $query } }
        { content: { contains: $query } }
        { meta__description: { like: $query } }
        { meta__description: { contains: $query } }
      ]
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query SearchNotesByAuthorTagIDsAndType(
  $query: String!
  $slug: String!
  $page: Int!
  $limit: Int!
  $tagIDs: [JSON!]!
  $postType: Micro_post_post_type_Input!
) {
  Micro_posts(
    page: $page
    limit: $limit
    sort: "-publishedAt"
    where: {
      _status: { equals: published }
      authorSlug: { equals: $slug }
      tags: { in: $tagIDs }
      post_type: { equals: $postType }
      OR: [
        { title: { like: $query } }
        { title: { contains: $query } }
        { content: { like: $query } }
        { content: { contains: $query } }
        { meta__description: { like: $query } }
        { meta__description: { contains: $query } }
      ]
    }
  ) {
    totalPages
    docs {
      ...NoteListDoc
    }
  }
}

query TagIDsByNames($tagNames: [String!]!) {
  Tags(where: { name: { in: $tagNames } }) {
    docs {
      id
      name
      title
    }
  }
}

query AvailableTagsByPostType($postType: String) {
  availableTagsByMicroPostType(postType: $postType) {
    id
    name
    title
  }
}

query AvailableAuthors($limit: Int!) {
  Authors(limit: $limit, sort: "name") {
    docs {
      id
      name
      slug
      bio
      avatar {
        url
        alt
        width
        height
      }
    }
  }
}

query AuthorBySlug($slug: String!) {
  Authors(where: { slug: { equals: $slug } }, limit: 1) {
    docs {
      id
      name
      slug
      bio
      avatar {
        url
        alt
        width
        height
      }
    }
  }
}

query TagByName($name: String!) {
  Tags(where: { name: { equals: $name } }, limit: 1) {
    docs {
      id
      name
      title
    }
  }
}

query NoteBySlug($slug: String!) {
  Micro_posts(
    limit: 1
    where: {
      _status: { equals: published }
      slug: { equals: $slug }
    }
  ) {
    docs {
      id
      slug
      title
      content
      publishedAt
      authors {
        name
        slug
        bio
        avatar {
          url
          alt
          width
          height
        }
      }
      tags {
        id
        name
        title
      }
      attachment {
        url
        alt
        width
        height
        filename
        mimeType
      }
      externalLinks {
        id
        target_url
      }
      linkedMicroPosts {
        id
        slug
      }
      meta {
        title
        description
      }
    }
  }
}
